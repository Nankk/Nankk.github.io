shadow$provide.module$node_modules$node_forge$lib$cipherModes=function(global,require,module,exports){function transformIV(iv,blockSize){"string"===typeof iv&&(iv=forge.util.createBuffer(iv));if(forge.util.isArray(iv)&&4<iv.length){var tmp=iv;iv=forge.util.createBuffer();for(var i=0;i<tmp.length;++i)iv.putByte(tmp[i])}if(iv.length()<blockSize)throw Error("Invalid IV length; got "+iv.length()+" bytes and expected "+blockSize+" bytes.");if(!forge.util.isArray(iv)){tmp=[];blockSize/=4;for(i=0;i<blockSize;++i)tmp.push(iv.getInt32());
iv=tmp}return iv}function inc32(block){block[block.length-1]=block[block.length-1]+1&4294967295}function from64To32(num){return[num/4294967296|0,num&4294967295]}var forge=require("module$node_modules$node_forge$lib$forge");require("module$node_modules$node_forge$lib$util");forge.cipher=forge.cipher||{};global=module.exports=forge.cipher.modes=forge.cipher.modes||{};global.ecb=function(options){options=options||{};this.name="ECB";this.cipher=options.cipher;this.blockSize=options.blockSize||16;this._ints=
this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};global.ecb.prototype.start=function(options){};global.ecb.prototype.encrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&0<input.length()))return!0;for(finish=0;finish<this._ints;++finish)this._inBlock[finish]=input.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(finish=0;finish<this._ints;++finish)output.putInt32(this._outBlock[finish])};global.ecb.prototype.decrypt=function(input,
output,finish){if(input.length()<this.blockSize&&!(finish&&0<input.length()))return!0;for(finish=0;finish<this._ints;++finish)this._inBlock[finish]=input.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(finish=0;finish<this._ints;++finish)output.putInt32(this._outBlock[finish])};global.ecb.prototype.pad=function(input,options){options=input.length()===this.blockSize?this.blockSize:this.blockSize-input.length();input.fillWithByte(options,options);return!0};global.ecb.prototype.unpad=
function(output,options){if(0<options.overflow)return!1;options=output.length();options=output.at(options-1);if(options>this.blockSize<<2)return!1;output.truncate(options);return!0};global.cbc=function(options){options=options||{};this.name="CBC";this.cipher=options.cipher;this.blockSize=options.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};global.cbc.prototype.start=function(options){if(null===options.iv){if(!this._prev)throw Error("Invalid IV parameter.");
this._iv=this._prev.slice(0)}else if("iv"in options)this._iv=transformIV(options.iv,this.blockSize),this._prev=this._iv.slice(0);else throw Error("Invalid IV parameter.");};global.cbc.prototype.encrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&0<input.length()))return!0;for(finish=0;finish<this._ints;++finish)this._inBlock[finish]=this._prev[finish]^input.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(finish=0;finish<this._ints;++finish)output.putInt32(this._outBlock[finish]);
this._prev=this._outBlock};global.cbc.prototype.decrypt=function(input,output,finish){if(input.length()<this.blockSize&&!(finish&&0<input.length()))return!0;for(finish=0;finish<this._ints;++finish)this._inBlock[finish]=input.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(finish=0;finish<this._ints;++finish)output.putInt32(this._prev[finish]^this._outBlock[finish]);this._prev=this._inBlock.slice(0)};global.cbc.prototype.pad=function(input,options){options=input.length()===this.blockSize?
this.blockSize:this.blockSize-input.length();input.fillWithByte(options,options);return!0};global.cbc.prototype.unpad=function(output,options){if(0<options.overflow)return!1;options=output.length();options=output.at(options-1);if(options>this.blockSize<<2)return!1;output.truncate(options);return!0};global.cfb=function(options){options=options||{};this.name="CFB";this.cipher=options.cipher;this.blockSize=options.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);
this._partialBlock=Array(this._ints);this._partialOutput=forge.util.createBuffer();this._partialBytes=0};global.cfb.prototype.start=function(options){if(!("iv"in options))throw Error("Invalid IV parameter.");this._iv=transformIV(options.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};global.cfb.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&
inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32()^this._outBlock[i],output.putInt32(this._inBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;0<partialBytes&&(partialBytes=this.blockSize-partialBytes);this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=input.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(0<partialBytes)input.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=
this._partialBlock[i];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<partialBytes&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes));this._partialBytes=0}};global.cfb.prototype.decrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);
if(0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=input.getInt32(),output.putInt32(this._inBlock[i]^this._outBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;0<partialBytes&&(partialBytes=this.blockSize-partialBytes);this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=input.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(0<partialBytes)input.read-=this.blockSize;
else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<partialBytes&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes));this._partialBytes=0}};global.ofb=function(options){options=options||{};this.name="OFB";this.cipher=options.cipher;this.blockSize=options.blockSize||
16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialOutput=forge.util.createBuffer();this._partialBytes=0};global.ofb.prototype.start=function(options){if(!("iv"in options))throw Error("Invalid IV parameter.");this._iv=transformIV(options.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};global.ofb.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===input.length())return!0;this.cipher.encrypt(this._inBlock,
this._outBlock);if(0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)output.putInt32(input.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;0<partialBytes&&(partialBytes=this.blockSize-partialBytes);this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);if(0<partialBytes)input.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=
this._outBlock[i];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<partialBytes&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes));this._partialBytes=0}};global.ofb.prototype.decrypt=global.ofb.prototype.encrypt;global.ctr=function(options){options=options||{};this.name="CTR";this.cipher=options.cipher;this.blockSize=
options.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialOutput=forge.util.createBuffer();this._partialBytes=0};global.ctr.prototype.start=function(options){if(!("iv"in options))throw Error("Invalid IV parameter.");this._iv=transformIV(options.iv,this.blockSize);this._inBlock=this._iv.slice(0);this._partialBytes=0};global.ctr.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;this.cipher.encrypt(this._inBlock,
this._outBlock);if(0===this._partialBytes&&inputLength>=this.blockSize)for(var i=0;i<this._ints;++i)output.putInt32(input.getInt32()^this._outBlock[i]);else{var partialBytes=(this.blockSize-inputLength)%this.blockSize;0<partialBytes&&(partialBytes=this.blockSize-partialBytes);this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);0<partialBytes&&(input.read-=this.blockSize);0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);
if(0<partialBytes&&!finish)return output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes));this._partialBytes=0}inc32(this._inBlock)};global.ctr.prototype.decrypt=global.ctr.prototype.encrypt;global.gcm=function(options){options=options||{};this.name="GCM";this.cipher=options.cipher;this.blockSize=options.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);
this._outBlock=Array(this._ints);this._partialOutput=forge.util.createBuffer();this._partialBytes=0;this._R=3774873600};global.gcm.prototype.start=function(options){if(!("iv"in options))throw Error("Invalid IV parameter.");var iv=forge.util.createBuffer(options.iv);this._cipherLength=0;var additionalData="additionalData"in options?forge.util.createBuffer(options.additionalData):forge.util.createBuffer();this._tagLength="tagLength"in options?options.tagLength:128;this._tag=null;if(options.decrypt&&
(this._tag=forge.util.createBuffer(options.tag).getBytes(),this._tag.length!==this._tagLength/8))throw Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints);this.tag=null;this._hashSubkey=Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);options=iv.length();if(12===options)this._j0=[iv.getInt32(),iv.getInt32(),iv.getInt32(),1];else{for(this._j0=[0,0,0,0];0<iv.length();)this._j0=
this.ghash(this._hashSubkey,this._j0,[iv.getInt32(),iv.getInt32(),iv.getInt32(),iv.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(8*options)))}this._inBlock=this._j0.slice(0);inc32(this._inBlock);this._partialBytes=0;additionalData=forge.util.createBuffer(additionalData);this._aDataLength=from64To32(8*additionalData.length());(iv=additionalData.length()%this.blockSize)&&additionalData.fillWithByte(0,this.blockSize-iv);for(this._s=[0,0,0,0];0<additionalData.length();)this._s=
this.ghash(this._hashSubkey,this._s,[additionalData.getInt32(),additionalData.getInt32(),additionalData.getInt32(),additionalData.getInt32()])};global.gcm.prototype.encrypt=function(input,output,finish){var inputLength=input.length();if(0===inputLength)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&inputLength>=this.blockSize){for(var i=0;i<this._ints;++i)output.putInt32(this._outBlock[i]^=input.getInt32());this._cipherLength+=this.blockSize}else{var partialBytes=
(this.blockSize-inputLength)%this.blockSize;0<partialBytes&&(partialBytes=this.blockSize-partialBytes);this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(input.getInt32()^this._outBlock[i]);if(0>=partialBytes||finish){finish?(i=inputLength%this.blockSize,this._cipherLength+=i,this._partialOutput.truncate(this.blockSize-i)):this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}0<
this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<partialBytes&&!finish)return input.read-=this.blockSize,output.putBytes(this._partialOutput.getBytes(partialBytes-this._partialBytes)),this._partialBytes=partialBytes,!0;output.putBytes(this._partialOutput.getBytes(inputLength-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);inc32(this._inBlock)};global.gcm.prototype.decrypt=function(input,output,finish){var inputLength=input.length();
if(inputLength<this.blockSize&&!(finish&&0<inputLength))return!0;this.cipher.encrypt(this._inBlock,this._outBlock);inc32(this._inBlock);this._hashBlock[0]=input.getInt32();this._hashBlock[1]=input.getInt32();this._hashBlock[2]=input.getInt32();this._hashBlock[3]=input.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(input=0;input<this._ints;++input)output.putInt32(this._outBlock[input]^this._hashBlock[input]);this._cipherLength=inputLength<this.blockSize?this._cipherLength+
inputLength%this.blockSize:this._cipherLength+this.blockSize};global.gcm.prototype.afterFinish=function(output,options){var rval=!0;options.decrypt&&options.overflow&&output.truncate(this.blockSize-options.overflow);this.tag=forge.util.createBuffer();output=this._aDataLength.concat(from64To32(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,output);output=[];this.cipher.encrypt(this._j0,output);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^output[i]);this.tag.truncate(this.tag.length()%
(this._tagLength/8));options.decrypt&&this.tag.bytes()!==this._tag&&(rval=!1);return rval};global.gcm.prototype.multiply=function(x,y){var z_i=[0,0,0,0];y=y.slice(0);for(var i=0;128>i;++i)x[i/32|0]&1<<31-i%32&&(z_i[0]^=y[0],z_i[1]^=y[1],z_i[2]^=y[2],z_i[3]^=y[3]),this.pow(y,y);return z_i};global.gcm.prototype.pow=function(x,out){for(var lsb=x[3]&1,i=3;0<i;--i)out[i]=x[i]>>>1|(x[i-1]&1)<<31;out[0]=x[0]>>>1;lsb&&(out[0]^=this._R)};global.gcm.prototype.tableMultiply=function(x){for(var z=[0,0,0,0],i=
0;32>i;++i){var ah=this._m[i][x[i/8|0]>>>4*(7-i%8)&15];z[0]^=ah[0];z[1]^=ah[1];z[2]^=ah[2];z[3]^=ah[3]}return z};global.gcm.prototype.ghash=function(h,y,x){y[0]^=x[0];y[1]^=x[1];y[2]^=x[2];y[3]^=x[3];return this.tableMultiply(y)};global.gcm.prototype.generateHashTable=function(h,bits){var multiplier=8/bits,perInt=4*multiplier;multiplier*=16;for(var m=Array(multiplier),i=0;i<multiplier;++i){var tmp=[0,0,0,0];tmp[i/perInt|0]=1<<bits-1<<(perInt-1-i%perInt)*bits;m[i]=this.generateSubHashTable(this.multiply(tmp,
h),bits)}return m};global.gcm.prototype.generateSubHashTable=function(mid,bits){bits=1<<bits;var half=bits>>>1,m=Array(bits);m[half]=mid.slice(0);for(var i=half>>>1;0<i;)this.pow(m[2*i],m[i]=[]),i>>=1;for(i=2;i<half;){for(var j=1;j<i;++j){var m_i=m[i],m_j=m[j];m[i+j]=[m_i[0]^m_j[0],m_i[1]^m_j[1],m_i[2]^m_j[2],m_i[3]^m_j[3]]}i*=2}m[0]=[0,0,0,0];for(i=half+1;i<bits;++i)j=m[i^half],m[i]=[mid[0]^j[0],mid[1]^j[1],mid[2]^j[2],mid[3]^j[3]];return m}}
//# sourceMappingURL=module$node_modules$node_forge$lib$cipherModes.js.map
