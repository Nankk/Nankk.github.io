{
"version":3,
"file":"module$node_modules$jws$lib$verify_stream.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/jws/lib/verify-stream.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$jws$lib$verify_stream\"] = function(global,require,module,exports) {\n/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\nvar JWS_REGEX = /^[a-zA-Z0-9\\-_]+?\\.[a-zA-Z0-9\\-_]+?\\.([a-zA-Z0-9\\-_]+)?$/;\n\nfunction isObject(thing) {\n  return Object.prototype.toString.call(thing) === '[object Object]';\n}\n\nfunction safeJsonParse(thing) {\n  if (isObject(thing))\n    return thing;\n  try { return JSON.parse(thing); }\n  catch (e) { return undefined; }\n}\n\nfunction headerFromJWS(jwsSig) {\n  var encodedHeader = jwsSig.split('.', 1)[0];\n  return safeJsonParse(Buffer.from(encodedHeader, 'base64').toString('binary'));\n}\n\nfunction securedInputFromJWS(jwsSig) {\n  return jwsSig.split('.', 2).join('.');\n}\n\nfunction signatureFromJWS(jwsSig) {\n  return jwsSig.split('.')[2];\n}\n\nfunction payloadFromJWS(jwsSig, encoding) {\n  encoding = encoding || 'utf8';\n  var payload = jwsSig.split('.')[1];\n  return Buffer.from(payload, 'base64').toString(encoding);\n}\n\nfunction isValidJws(string) {\n  return JWS_REGEX.test(string) && !!headerFromJWS(string);\n}\n\nfunction jwsVerify(jwsSig, algorithm, secretOrKey) {\n  if (!algorithm) {\n    var err = new Error(\"Missing algorithm parameter for jws.verify\");\n    err.code = \"MISSING_ALGORITHM\";\n    throw err;\n  }\n  jwsSig = toString(jwsSig);\n  var signature = signatureFromJWS(jwsSig);\n  var securedInput = securedInputFromJWS(jwsSig);\n  var algo = jwa(algorithm);\n  return algo.verify(securedInput, signature, secretOrKey);\n}\n\nfunction jwsDecode(jwsSig, opts) {\n  opts = opts || {};\n  jwsSig = toString(jwsSig);\n\n  if (!isValidJws(jwsSig))\n    return null;\n\n  var header = headerFromJWS(jwsSig);\n\n  if (!header)\n    return null;\n\n  var payload = payloadFromJWS(jwsSig);\n  if (header.typ === 'JWT' || opts.json)\n    payload = JSON.parse(payload, opts.encoding);\n\n  return {\n    header: header,\n    payload: payload,\n    signature: signatureFromJWS(jwsSig)\n  };\n}\n\nfunction VerifyStream(opts) {\n  opts = opts || {};\n  var secretOrKey = opts.secret||opts.publicKey||opts.key;\n  var secretStream = new DataStream(secretOrKey);\n  this.readable = true;\n  this.algorithm = opts.algorithm;\n  this.encoding = opts.encoding;\n  this.secret = this.publicKey = this.key = secretStream;\n  this.signature = new DataStream(opts.signature);\n  this.secret.once('close', function () {\n    if (!this.signature.writable && this.readable)\n      this.verify();\n  }.bind(this));\n\n  this.signature.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.verify();\n  }.bind(this));\n}\nutil.inherits(VerifyStream, Stream);\nVerifyStream.prototype.verify = function verify() {\n  try {\n    var valid = jwsVerify(this.signature.buffer, this.algorithm, this.key.buffer);\n    var obj = jwsDecode(this.signature.buffer, this.encoding);\n    this.emit('done', valid, obj);\n    this.emit('data', valid);\n    this.emit('end');\n    this.readable = false;\n    return valid;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nVerifyStream.decode = jwsDecode;\nVerifyStream.isValid = isValidJws;\nVerifyStream.verify = jwsVerify;\n\nmodule.exports = VerifyStream;\n\n};"],
"names":["shadow$provide","global","require","module","exports","headerFromJWS","jwsSig","encodedHeader","split","Buffer","from","toString","Object","prototype","call","thing","JSON","parse","e","undefined","isValidJws","string","JWS_REGEX","test","jwsVerify","algorithm","secretOrKey","err","Error","code","signature","securedInput","join","jwa","algo","verify","jwsDecode","opts","header","encoding","payload","typ","json","VerifyStream","secretStream","DataStream","secret","publicKey","key","readable","once","writable","bind","Stream","util","inherits","VerifyStream.prototype.verify","valid","buffer","obj","emit","decode","isValid"]
}
