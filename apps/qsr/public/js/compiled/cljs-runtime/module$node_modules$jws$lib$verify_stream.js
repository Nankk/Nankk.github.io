shadow$provide.module$node_modules$jws$lib$verify_stream=function(global,require,module,exports){function headerFromJWS(jwsSig){jwsSig=jwsSig.split(".",1)[0];jwsSig=Buffer.from(jwsSig,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(jwsSig))var JSCompiler_inline_result=jwsSig;else try{JSCompiler_inline_result=JSON.parse(jwsSig)}catch(e){JSCompiler_inline_result=void 0}return JSCompiler_inline_result}function isValidJws(string){return JWS_REGEX.test(string)&&!!headerFromJWS(string)}
function jwsVerify(jwsSig,algorithm,secretOrKey){if(!algorithm)throw algorithm=Error("Missing algorithm parameter for jws.verify"),algorithm.code="MISSING_ALGORITHM",algorithm;jwsSig=toString(jwsSig);var signature=jwsSig.split(".")[2];jwsSig=jwsSig.split(".",2).join(".");return jwa(algorithm).verify(jwsSig,signature,secretOrKey)}function jwsDecode(jwsSig,opts){opts=opts||{};jwsSig=toString(jwsSig);if(!isValidJws(jwsSig))return null;var header=headerFromJWS(jwsSig);if(!header)return null;var payload=
"utf8";var payload$jscomp$0=jwsSig.split(".")[1];payload=Buffer.from(payload$jscomp$0,"base64").toString(payload);if("JWT"===header.typ||opts.json)payload=JSON.parse(payload,opts.encoding);return{header:header,payload:payload,signature:jwsSig.split(".")[2]}}function VerifyStream(opts){opts=opts||{};var secretStream=new DataStream(opts.secret||opts.publicKey||opts.key);this.readable=!0;this.algorithm=opts.algorithm;this.encoding=opts.encoding;this.secret=this.publicKey=this.key=secretStream;this.signature=
new DataStream(opts.signature);this.secret.once("close",function(){!this.signature.writable&&this.readable&&this.verify()}.bind(this));this.signature.once("close",function(){!this.secret.writable&&this.readable&&this.verify()}.bind(this))}var Buffer=require("module$node_modules$safe_buffer$index").Buffer,DataStream=require("module$node_modules$jws$lib$data_stream"),jwa=require("module$node_modules$jwa$index");global=require("module$node_modules$stream_browserify$index");var toString=require("module$node_modules$jws$lib$tostring"),
JWS_REGEX=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;require("module$node_modules$util$util").inherits(VerifyStream,global);VerifyStream.prototype.verify=function(){try{var valid=jwsVerify(this.signature.buffer,this.algorithm,this.key.buffer),obj=jwsDecode(this.signature.buffer,this.encoding);this.emit("done",valid,obj);this.emit("data",valid);this.emit("end");this.readable=!1;return valid}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}};VerifyStream.decode=jwsDecode;
VerifyStream.isValid=isValidJws;VerifyStream.verify=jwsVerify;module.exports=VerifyStream}
//# sourceMappingURL=module$node_modules$jws$lib$verify_stream.js.map
