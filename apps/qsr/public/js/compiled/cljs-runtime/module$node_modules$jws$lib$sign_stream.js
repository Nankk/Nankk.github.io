shadow$provide.module$node_modules$jws$lib$sign_stream=function(global,require,module,exports){function base64url(string,encoding){return Buffer.from(string,encoding).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jwsSign(opts){var header=opts.header,payload=opts.payload,secretOrKey=opts.secret||opts.privateKey,encoding=opts.encoding;opts=jwa(header.alg);encoding=encoding||"utf8";header=base64url(toString(header),"binary");payload=base64url(toString(payload),encoding);
payload=util.format("%s.%s",header,payload);secretOrKey=opts.sign(payload,secretOrKey);return util.format("%s.%s",payload,secretOrKey)}function SignStream(opts){var secretStream=new DataStream(opts.secret||opts.privateKey||opts.key);this.readable=!0;this.header=opts.header;this.encoding=opts.encoding;this.secret=this.privateKey=this.key=secretStream;this.payload=new DataStream(opts.payload);this.secret.once("close",function(){!this.payload.writable&&this.readable&&this.sign()}.bind(this));this.payload.once("close",
function(){!this.secret.writable&&this.readable&&this.sign()}.bind(this))}var Buffer=require("module$node_modules$safe_buffer$index").Buffer,DataStream=require("module$node_modules$jws$lib$data_stream"),jwa=require("module$node_modules$jwa$index");global=require("module$node_modules$stream_browserify$index");var toString=require("module$node_modules$jws$lib$tostring"),util=require("module$node_modules$util$util");util.inherits(SignStream,global);SignStream.prototype.sign=function(){try{var signature=
jwsSign({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});this.emit("done",signature);this.emit("data",signature);this.emit("end");this.readable=!1;return signature}catch(e){this.readable=!1,this.emit("error",e),this.emit("close")}};SignStream.sign=jwsSign;module.exports=SignStream}
//# sourceMappingURL=module$node_modules$jws$lib$sign_stream.js.map
