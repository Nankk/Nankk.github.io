{
"version":3,
"file":"module$node_modules$agent_base$index.js",
"lineCount":5,
"mappings":"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",
"sources":["node_modules/agent-base/index.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$agent_base$index\"] = function(global,require,module,exports) {\n'use strict';\nrequire('./patch-core');\nconst inherits = require('util').inherits;\nconst promisify = require('es6-promisify');\nconst EventEmitter = require('events').EventEmitter;\n\nmodule.exports = Agent;\n\nfunction isAgent(v) {\n  return v && typeof v.addRequest === 'function';\n}\n\n/**\n * Base `http.Agent` implementation.\n * No pooling/keep-alive is implemented by default.\n *\n * @param {Function} callback\n * @api public\n */\nfunction Agent(callback, _opts) {\n  if (!(this instanceof Agent)) {\n    return new Agent(callback, _opts);\n  }\n\n  EventEmitter.call(this);\n\n  // The callback gets promisified if it has 3 parameters\n  // (i.e. it has a callback function) lazily\n  this._promisifiedCallback = false;\n\n  let opts = _opts;\n  if ('function' === typeof callback) {\n    this.callback = callback;\n  } else if (callback) {\n    opts = callback;\n  }\n\n  // timeout for the socket to be returned from the callback\n  this.timeout = (opts && opts.timeout) || null;\n\n  this.options = opts;\n}\ninherits(Agent, EventEmitter);\n\n/**\n * Override this function in your subclass!\n */\nAgent.prototype.callback = function callback(req, opts) {\n  throw new Error(\n    '\"agent-base\" has no default implementation, you must subclass and override `callback()`'\n  );\n};\n\n/**\n * Called by node-core's \"_http_client.js\" module when creating\n * a new HTTP request with this Agent instance.\n *\n * @api public\n */\nAgent.prototype.addRequest = function addRequest(req, _opts) {\n  const ownOpts = Object.assign({}, _opts);\n\n  // Set default `host` for HTTP to localhost\n  if (null == ownOpts.host) {\n    ownOpts.host = 'localhost';\n  }\n\n  // Set default `port` for HTTP if none was explicitly specified\n  if (null == ownOpts.port) {\n    ownOpts.port = ownOpts.secureEndpoint ? 443 : 80;\n  }\n\n  const opts = Object.assign({}, this.options, ownOpts);\n\n  if (opts.host && opts.path) {\n    // If both a `host` and `path` are specified then it's most likely the\n    // result of a `url.parse()` call... we need to remove the `path` portion so\n    // that `net.connect()` doesn't attempt to open that as a unix socket file.\n    delete opts.path;\n  }\n\n  delete opts.agent;\n  delete opts.hostname;\n  delete opts._defaultAgent;\n  delete opts.defaultPort;\n  delete opts.createConnection;\n\n  // Hint to use \"Connection: close\"\n  // XXX: non-documented `http` module API :(\n  req._last = true;\n  req.shouldKeepAlive = false;\n\n  // Create the `stream.Duplex` instance\n  let timeout;\n  let timedOut = false;\n  const timeoutMs = this.timeout;\n  const freeSocket = this.freeSocket;\n\n  function onerror(err) {\n    if (req._hadError) return;\n    req.emit('error', err);\n    // For Safety. Some additional errors might fire later on\n    // and we need to make sure we don't double-fire the error event.\n    req._hadError = true;\n  }\n\n  function ontimeout() {\n    timeout = null;\n    timedOut = true;\n    const err = new Error(\n      'A \"socket\" was not created for HTTP request before ' + timeoutMs + 'ms'\n    );\n    err.code = 'ETIMEOUT';\n    onerror(err);\n  }\n\n  function callbackError(err) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    onerror(err);\n  }\n\n  function onsocket(socket) {\n    if (timedOut) return;\n    if (timeout != null) {\n      clearTimeout(timeout);\n      timeout = null;\n    }\n    if (isAgent(socket)) {\n      // `socket` is actually an http.Agent instance, so relinquish\n      // responsibility for this `req` to the Agent from here on\n      socket.addRequest(req, opts);\n    } else if (socket) {\n      function onfree() {\n        freeSocket(socket, opts);\n      }\n      socket.on('free', onfree);\n      req.onSocket(socket);\n    } else {\n      const err = new Error(\n        'no Duplex stream was returned to agent-base for `' + req.method + ' ' + req.path + '`'\n      );\n      onerror(err);\n    }\n  }\n\n  if (!this._promisifiedCallback && this.callback.length >= 3) {\n    // Legacy callback function - convert to a Promise\n    this.callback = promisify(this.callback, this);\n    this._promisifiedCallback = true;\n  }\n\n  if (timeoutMs > 0) {\n    timeout = setTimeout(ontimeout, timeoutMs);\n  }\n\n  try {\n    Promise.resolve(this.callback(req, opts)).then(onsocket, callbackError);\n  } catch (err) {\n    Promise.reject(err).catch(callbackError);\n  }\n};\n\nAgent.prototype.freeSocket = function freeSocket(socket, opts) {\n  // TODO reuse sockets\n  socket.destroy();\n};\n\n};"],
"names":["shadow$provide","global","require","module","exports","Agent","callback","_opts","EventEmitter","call","_promisifiedCallback","opts","timeout","options","inherits","promisify","prototype","Agent.prototype.callback","req","Error","addRequest","Agent.prototype.addRequest","onerror","err","_hadError","emit","ontimeout","timedOut","timeoutMs","code","callbackError","clearTimeout","onsocket","socket","on","onfree","freeSocket","onSocket","method","path","ownOpts","Object","assign","host","port","secureEndpoint","agent","hostname","_defaultAgent","defaultPort","createConnection","_last","shouldKeepAlive","length","setTimeout","Promise","resolve","then","reject","catch","Agent.prototype.freeSocket","destroy"]
}
