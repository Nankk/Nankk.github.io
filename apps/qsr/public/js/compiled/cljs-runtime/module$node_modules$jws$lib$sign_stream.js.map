{
"version":3,
"file":"module$node_modules$jws$lib$sign_stream.js",
"lineCount":4,
"mappings":"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",
"sources":["node_modules/jws/lib/sign-stream.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$jws$lib$sign_stream\"] = function(global,require,module,exports) {\n/*global module*/\nvar Buffer = require('safe-buffer').Buffer;\nvar DataStream = require('./data-stream');\nvar jwa = require('jwa');\nvar Stream = require('stream');\nvar toString = require('./tostring');\nvar util = require('util');\n\nfunction base64url(string, encoding) {\n  return Buffer\n    .from(string, encoding)\n    .toString('base64')\n    .replace(/=/g, '')\n    .replace(/\\+/g, '-')\n    .replace(/\\//g, '_');\n}\n\nfunction jwsSecuredInput(header, payload, encoding) {\n  encoding = encoding || 'utf8';\n  var encodedHeader = base64url(toString(header), 'binary');\n  var encodedPayload = base64url(toString(payload), encoding);\n  return util.format('%s.%s', encodedHeader, encodedPayload);\n}\n\nfunction jwsSign(opts) {\n  var header = opts.header;\n  var payload = opts.payload;\n  var secretOrKey = opts.secret || opts.privateKey;\n  var encoding = opts.encoding;\n  var algo = jwa(header.alg);\n  var securedInput = jwsSecuredInput(header, payload, encoding);\n  var signature = algo.sign(securedInput, secretOrKey);\n  return util.format('%s.%s', securedInput, signature);\n}\n\nfunction SignStream(opts) {\n  var secret = opts.secret||opts.privateKey||opts.key;\n  var secretStream = new DataStream(secret);\n  this.readable = true;\n  this.header = opts.header;\n  this.encoding = opts.encoding;\n  this.secret = this.privateKey = this.key = secretStream;\n  this.payload = new DataStream(opts.payload);\n  this.secret.once('close', function () {\n    if (!this.payload.writable && this.readable)\n      this.sign();\n  }.bind(this));\n\n  this.payload.once('close', function () {\n    if (!this.secret.writable && this.readable)\n      this.sign();\n  }.bind(this));\n}\nutil.inherits(SignStream, Stream);\n\nSignStream.prototype.sign = function sign() {\n  try {\n    var signature = jwsSign({\n      header: this.header,\n      payload: this.payload.buffer,\n      secret: this.secret.buffer,\n      encoding: this.encoding\n    });\n    this.emit('done', signature);\n    this.emit('data', signature);\n    this.emit('end');\n    this.readable = false;\n    return signature;\n  } catch (e) {\n    this.readable = false;\n    this.emit('error', e);\n    this.emit('close');\n  }\n};\n\nSignStream.sign = jwsSign;\n\nmodule.exports = SignStream;\n\n};"],
"names":["shadow$provide","global","require","module","exports","base64url","string","encoding","Buffer","from","toString","replace","jwsSign","opts","header","payload","secretOrKey","secret","privateKey","algo","jwa","alg","encodedHeader","encodedPayload","util","format","signature","sign","securedInput","SignStream","secretStream","DataStream","key","readable","once","writable","bind","Stream","inherits","prototype","SignStream.prototype.sign","buffer","emit","e"]
}
